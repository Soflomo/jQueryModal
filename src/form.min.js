(function(c){c.fn.form=function(f,e){var f=c.extend({},c.fn.form.defaults,f),e=c.extend({},e);c(this).click(function(d){d.preventDefault();var g=c(this);c.ajax(g.attr("href"),{error:function(h,j,i){throw"Error during request for template"},success:function(h){a(g,c("<div>").html(h),f,e)}})});return this};function a(f,g,d,e){var h={};if(d.title===undefined){if(f.data("title")!==undefined){d.title=f.data("title")}else{d.title=f.text()}}h[d.cancel]=function(){g.dialog("close")};h[d.success]=function(){var i=g.find("form");if(d.ajax){c.ajax(i.attr("action"),{type:i.attr("method"),data:i.serialize(),error:function(j,l,k){d.onError(f,j,l,k);g.dialog("close")},success:function(k,l,j){if(b(k)){g.html(k)}else{d.onSuccess(f,k,l,j);g.dialog("close")}}})}else{i.trigger("submit");g.dialog("close")}};if(e.title===undefined){e.title=d.title}e.buttons=h;g.dialog(e)}function b(e){var d=c.fn.form.defaults.errored;if(c(e).find(d).length>0){return true}return false}c.fn.form.defaults={success:"Success",cancel:"Cancel",ajax:true,method:"GET",errored:"ul.errors",onSuccess:function(){},onError:function(){}}})(jQuery);
